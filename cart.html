<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--=============== FLATICON ===============-->
    <link
      rel="stylesheet"
      href="https://cdn-uicons.flaticon.com/2.0.0/uicons-regular-straight/css/uicons-regular-straight.css"
    />

    <!--=============== SWIPER CSS ===============-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />

    <!--=============== CSS ===============-->
    <link rel="stylesheet" href="./assets/css/styles.css" />

    <title>Ecommerce Website</title>
  </head>
  <body>
    <!--=============== HEADER ===============-->
      <div id="header"></div>
    <!--=============== MAIN ===============-->
    <main class="main">
      <!--=============== BREADCRUMB ===============-->
      <section class="breadcrumb">
        <ul class="breadcrumb__list flex container">
          <li><a href="index.html" class="breadcrumb__link">Home</a></li>
          <li><span class="breadcrumb__link"></span>></li>
          <li><span class="breadcrumb__link">Shop</span></li>
          <li><span class="breadcrumb__link"></span>></li>
          <li><span class="breadcrumb__link">Cart</span></li>
        </ul>
      </section>

      <!--=============== CART ===============-->


      <section class="cart section--lg container">
        <div class="table__container">
          <table class="table">
            <thead>
              <tr>
                <th>Image</th>
                <th>Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Subtotal</th>
                <th>Rename</th>
              </tr>
            </thead>
            <tbody></tbody>

          </table>
        </div> 

        <!-- <div class="cart__actions">
          <a href="#" class="btn flex btn__md">
            <i class="fi-rs-shuffle"></i> Update Cart
          </a>
          <a href="#" class="btn flex btn__md">
            <i class="fi-rs-shopping-bag"></i> Continue Shopping
          </a>
        </div> -->

        <div class="divider">
          <i class="fi fi-rs-fingerprint"></i>
        </div>
<marquee behavior="scroll" direction="left" scrollamount="5" style="color: red; font-weight: bold;">
⚙️ Installation Charges Applicable: ₹400 per Camera | Choose "Yes" to include installation in your order summary. | Fast & Secure Service at Your Doorstep!
</marquee>

<br> <br>

        <div class="cart__group grid">
          <div>
          <div class="cart__total">
            <h3 class="section__title">Cart Totals</h3>

            <div class="installation-option">
              <label for="installationSelect">Installation Needed?</label>
              <select id="installationSelect" class="form__input">
                <option value="no">No</option>
                <option value="yes">Yes</option>
              </select>
            </div>

            <table class="cart__total-table">
              <tr>
                <td><span class="cart__total-title">Cart Subtotal</span></td>
                <td><span class="cart__total-price" id="subtotal">₹0.00</span></td>
              </tr>
              <tr id="installRow" style="display: none;">
                <td><span class="cart__total-title">Installation Charges</span></td>
                <td><span class="cart__total-price" id="installCharge">₹0.00</span></td>
              </tr>
              <tr>
                <td><span class="cart__total-title">Total</span></td>
                <td><span class="cart__total-price" id="total">₹0.00</span></td>
              </tr>
            </table>

            <a href="checkout.html" class="btn flex btn--md">
              <i class="fi fi-rs-box-alt"></i> Proceed To Checkout
            </a>
          </div>
        </div>
      </section>


    </main>

    <!--=============== FOOTER ===============-->
      <div id="footer"></div>

    <!--=============== SWIPER JS ===============-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!--=============== MAIN JS ===============-->
    <script src="assets/js/main.js"></script>

    
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        const tbody = document.querySelector(".table tbody");
        const installationSelect = document.getElementById("installationSelect");
        const installRow = document.getElementById("installRow");
        const installCharge = document.getElementById("installCharge");
        const totalDisplay = document.getElementById("total");
        const subtotalDisplay = document.getElementById("subtotal");

        const installationPerCamera = 400;
        const cart = JSON.parse(localStorage.getItem("cart")) || [];

        function getNumberOfCameras() {
          let totalCameras = 0;
          document.querySelectorAll(".table tbody tr").forEach((row) => {
            const name = row.querySelector(".table__title").textContent.toLowerCase();
            const qty = parseInt(row.querySelector(".quantity").value) || 0;
            if (name.includes("camera")) {
              totalCameras += qty;
            }
          });
          return totalCameras;
        }

        function calculateTotals() {
          let subtotal = 0;

          document.querySelectorAll(".table tbody tr").forEach((row) => {
            const price = parseFloat(row.querySelector(".table__price").textContent.replace("₹", "")) || 0;
            const qty = parseInt(row.querySelector(".quantity").value) || 1;
            const rowTotal = price * qty;
            row.querySelector(".subtotal").textContent = `₹${rowTotal.toFixed(2)}`;
            subtotal += rowTotal;
          });

          const cameraCount = getNumberOfCameras();
          const installCost = (installationSelect.value === "yes") ? cameraCount * installationPerCamera : 0;

          if (installCost > 0) {
            installRow.style.display = "table-row";
          } else {
            installRow.style.display = "none";
          }

          installCharge.textContent = `₹${installCost.toFixed(2)}`;
          subtotalDisplay.textContent = `₹${subtotal.toFixed(2)}`;
          totalDisplay.textContent = `₹${(subtotal + installCost).toFixed(2)}`;
        }

        function renderCart() {
          tbody.innerHTML = "";
          cart.forEach((item, index) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td><img src="${item.image}" class="table__img" /></td>
              <td><h3 class="table__title">${item.name}</h3></td>
              <td><span class="table__price">₹${item.price}</span></td>
              <td><input type="number" value="${item.quantity || 1}" min="1" class="quantity" data-index="${index}" /></td>
              <td><span class="subtotal">₹${item.price}</span></td>
              <td><i class="fi fi-rs-trash table__trash" data-index="${index}"></i></td>
            `;
            tbody.appendChild(tr);
          });

          addEventListeners();
          calculateTotals();
        }

        function addEventListeners() {
          document.querySelectorAll(".quantity").forEach((input) => {
            input.addEventListener("change", () => {
              if (parseInt(input.value) < 1) input.value = 1;
              const index = input.dataset.index;
              cart[index].quantity = parseInt(input.value);
              localStorage.setItem("cart", JSON.stringify(cart)); // ✅ Save the new quantity
              calculateTotals();
            });
          });

          document.querySelectorAll(".table__trash").forEach((icon) => {
            icon.addEventListener("click", () => {
              const index = icon.dataset.index;
              cart.splice(index, 1);
              localStorage.setItem("cart", JSON.stringify(cart));
              renderCart();
            });
          });

          installationSelect.addEventListener("change", calculateTotals);
        }

        renderCart();
      });
    </script>





  </body>
</html>
